---
import '../styles/tokens.css';
import '../styles/utilities.css';
import Map from '../components/Map.astro';
import Inputs from '../components/Inputs.astro';
import Breakdown from '../components/Breakdown.astro';
import Assumptions from '../components/Assumptions.astro';
import ContextCards from '../components/ContextCards.astro';
import pack from '../../data/packs/2025.1.0.json';
import Modal from '../components/Modal.astro';
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self'; font-src 'self' data:;" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>T1 — State + Federal Tax Burden Map</title>
    <meta name="description" content="Interactive state tax burden estimator with optional federal layer." />
    <meta property="og:title" content="T1 — State + Federal Tax Burden Map" />
    <meta property="og:description" content="Interactive state & local tax burden estimator with optional federal layer." />
    <script type="application/ld+json">
    {JSON.stringify({
      "@context":"https://schema.org",
      "@type":"FAQPage",
      "mainEntity":[
        {"@type":"Question","name":"What taxes are included?","acceptedAnswer":{"@type":"Answer","text":"State income, sales, property, fuel, and optional excise. Federal income, payroll, and LTCG are optional toggles."}},
        {"@type":"Question","name":"Where does the data come from?","acceptedAnswer":{"@type":"Answer","text":"Official DoR/DOT/ACS/BEA/BLS/IRS sources compiled into a versioned pack with a provenance registry."}}
      ]
    })}
    </script>
  </head>
  <body>
    <main class="container grid grid--sidebar">
      <section class="panel stack">
        <h1 class="heading--tight">T1 — State + Federal Tax Burden Map</h1>
        <div class="badge">Pack <strong>{pack.registry.pack_version}</strong> • built {pack.registry.built_at}</div>

        <Inputs id="inputs" />
        <Assumptions pack={pack} />
      </section>

      <section class="stack">
          <Map />
<Breakdown />
          <ContextCards pack={pack} initialState="CA" />
      </section>
    </main>
    <script type="module">
      try {
        const t = document.querySelector('h1.heading--tight');
        if (t) t.textContent = 'T1 — State + Federal Tax Burden Map';
        const badge = document.querySelector('.badge');
        if (badge) badge.innerHTML = badge.innerHTML.replace(/built.*/, (m)=>m.replace(/.+?built/,' — built'));
        const og = document.querySelector('meta[property="og:title"]');
        if (og) og.setAttribute('content','T1 — State + Federal Tax Burden Map');
        document.title = 'T1 — State + Federal Tax Burden Map';
      } catch {}
    </script>
  </body>
</html>
